SELECT TM1IGNORE_BADTUPLES {[plan_Period].[plan_Period].[Planning Driver],[plan_Period].[plan_Period].[Percentage Change],[plan_Period].[plan_Period].[Annual Input],STRTOSET("EXCEPT(TM1FILTERBYLEVEL(DRILLDOWNMEMBER({[plan_Period].[plan_Period].[" + [plan_Version_Control].([plan_Version].[plan_Version].CURRENTMEMBER,[plan_Version_Control_Measure].[plan_Version_Control_Measure].[Plan Year]) + "]} , {[plan_Period].[plan_Period].[" + [plan_Version_Control].([plan_Version].[plan_Version].CURRENTMEMBER,[plan_Version_Control_Measure].[plan_Version_Control_Measure].[Plan Year]) + "]} , RECURSIVE) , 0) , {[plan_Period].[plan_Period].[" + [plan_Version_Control].([plan_Version].[plan_Version].CURRENTMEMBER,[plan_Version_Control_Measure].[plan_Version_Control_Measure].[Plan Year]) + " 0]})"),[plan_Period].[plan_Period].[Linked for Input]} ON 0, TM1IGNORE_BADTUPLES NON EMPTY {TM1FILTERBYLEVEL({{DISTINCT({DESCENDANTS([Business_Unit].[Business_Unit].[Fletcher Steel Exc CSP])})}}, 0)}*{EXCEPT(DRILLDOWNMEMBER({[Branch].[Branch].[TOTAL_BRANCH]} , {[Branch].[Branch].[TOTAL_BRANCH]} , RECURSIVE) , {[Branch].[Branch].[TOTAL_BRANCH]})}*{TM1FILTERBYLEVEL(DISTINCT(DESCENDANTS([Customer_Sales].[Customer_Sales].[Customer_by_Business_Unit])) , 0)}*{DRILLDOWNMEMBER({[Product_Group].[Product_Group].[Dimond & CSR Products^DI_HIGH RIB ROOFING]}, {[Product_Group].[Product_Group].[Dimond & CSR Products^DI_HIGH RIB ROOFING]})} ON 1 FROM [plan_Sales] WHERE ([plan_Version].[plan_Version].[Budget], [Currency_Sales].[Currency_Sales].[NZD], [m_plan_Sales].[m_plan_Sales].[Sales Volume - LM])